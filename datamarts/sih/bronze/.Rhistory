setwd("~/projetos/datasus-etl/datamarts/sih")
library(read.dbc)
# define o diretório em que os arquivos .dbc estão armazenados
setwd("caminho/para/a/pasta")
# define o diretório em que os arquivos .dbc estão armazenados
setwd("bronze")
# lista todos os arquivos .dbc na pasta
arquivos <- list.files(pattern = "\\.dbc$")
# loop através de todos os arquivos na lista
for (i in 1:length(arquivos)) {
# lê o arquivo .dbc
dados <- read.dbc(arquivos[i])
# converte os dados em um dataframe
df <- as.data.frame(dados)
# grava o dataframe em um arquivo CSV
write.csv(df, file = paste0(arquivos[i], ".csv"), row.names = FALSE, sep = ";", fileEncoding = "utf-8")
}
library(read.dbc)
# define o diretório em que os arquivos .dbc estão armazenados
setwd("caminho/para/a/pasta")
# define o diretório em que os arquivos .dbc estão armazenados
setwd("bronze")
library(read.dbc)
# define o diretório em que os arquivos .dbc estão armazenados
setwd("bronze")
setwd("~/projetos/datasus-etl/datamarts/sih")
library(read.dbc)
# define o diretório em que os arquivos .dbc estão armazenados
setwd("bronze")
# lista todos os arquivos .dbc na pasta
arquivos <- list.files(pattern = "\\.dbc$")
# loop através de todos os arquivos na lista
for (i in 1:length(arquivos)) {
# lê o arquivo .dbc
dados <- read.dbc(arquivos[i])
# converte os dados em um dataframe
df <- as.data.frame(dados)
# define o nome do arquivo CSV
nome_csv <- gsub("\\.dbc$", ".csv", arquivos[i])
# grava o dataframe em um arquivo CSV
write.csv(df, file = nome_csv, row.names = FALSE, sep = ";", fileEncoding = "utf-8")
}
